<div class="panel max-w-6xl mx-auto mt-6 p-6 bg-white rounded-xl shadow space-y-6">

  <h3 class="text-lg font-semibold">
    üìù Assign Topic & Media to Class Slots
  </h3>

  <!-- ================= BATCH SELECT ================= -->
  <select
    [(ngModel)]="selectedBatchCode"
    (change)="onBatchChange()"
    class="w-full border rounded px-3 py-2"
  >
    <option value="">-- Select Batch --</option>
    <option *ngFor="let b of batches" [value]="b.batch_code">
      {{ b.batch_name }}
    </option>
  </select>

  <!-- ================= CLASS SLOTS ================= -->
  <div *ngIf="classes.length" class="space-y-4">

    <div
      *ngFor="let c of classes"
      class="border rounded p-4 space-y-4"
    >

      <!-- HEADER -->
      <div class="flex gap-4 items-start">
        <div class="w-56">
          <div class="font-semibold">
            üìÖ {{ c.display_date }}
          </div>

          <div class="text-xs text-gray-500 space-y-1 mt-1">
            <div *ngFor="let t of c.slot_times">
              ‚è∞ {{ t }}
            </div>
          </div>
        </div>

        <!-- TOPIC SELECT -->
        <select
          [(ngModel)]="c.selectedTopicId"
          (change)="onSlotTopicChange(c)"
          class="flex-1 border rounded px-3 py-2 text-sm"
        >
          <option value="">-- Select Topic --</option>
          <option *ngFor="let t of topics" [value]="t.id">
            {{ t.topic_name }}
          </option>
        </select>

        <!-- ASSIGN -->
        <button
          [disabled]="!c.selectedTopicId"
          (click)="assignTopicAndMedia(c)"
          class="bg-[#8b6f63] disabled:opacity-50 text-white px-4 py-2 rounded text-sm"
        >
          Assign
        </button>
      </div>

      <!-- ================= MEDIA LIST ================= -->
      <div
        *ngIf="c.topicMedia?.length"
        class="border rounded p-3 bg-gray-50"
      >
        <h4 class="font-semibold text-sm mb-2">
          üìÇ Topic Media
        </h4>

        <div class="space-y-1">
          <label
            *ngFor="let m of c.topicMedia"
            class="flex items-center gap-2 text-sm"
          >
            <input type="checkbox" [(ngModel)]="m.selected" />
            {{ m.title || m.file_name }}
            <span class="text-xs text-gray-400">
              ({{ m.mime_type }})
            </span>
          </label>
        </div>
      </div>

    </div>
  </div>

</div>
