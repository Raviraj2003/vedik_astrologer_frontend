<div class="panel mt-4 px-2 sm:px-6">

  <!-- HEADER -->
  <div class="mb-4 flex items-center justify-between">
    <h5 class="text-base sm:text-lg font-semibold">
      ğŸ“š My Class Schedule
    </h5>
    <span *ngIf="isLoading" class="text-sm text-gray-400">Loading...</span>
  </div>

  <!-- TABS -->
  <div class="flex gap-2 mb-4">
    <button
      *ngFor="let tab of tabs"
      (click)="setActiveTab(tab)"
      [ngClass]="{
        'bg-[#8b6f63] text-white': activeTab === tab,
        'bg-[#f3ece8] text-[#6c524d]': activeTab !== tab
      }"
      class="px-4 py-1.5 rounded-md text-sm"
    >
      {{ getTabLabel(tab) }}
    </button>
  </div>

  <!-- DATE CARDS -->
  <ng-container *ngIf="groupedSchedules.length; else noData">
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5">

      <div
        *ngFor="let group of groupedSchedules"
        class="bg-white border rounded-xl p-4 shadow-sm"
      >
        <!-- DATE -->
        <div class="text-center mb-3">
          <h6 class="font-semibold text-sm">
            ğŸ“… {{ group.date | date: "dd MMM yyyy" }}
          </h6>
          <div class="text-xs text-gray-500">
            {{ group.date | date: "EEEE" }}
          </div>
        </div>

        <!-- CARD -->
        <div class="border rounded p-3 space-y-3">

          <!-- TOPIC -->
       <!-- TOPIC -->
<p
  class="text-sm font-medium"
  [ngClass]="
    group.classes[0]?.topic_name
      ? 'text-gray-800 dark:text-gray-200'
      : 'text-amber-600 dark:text-amber-400'
  "
>
  ğŸ“˜ {{ group.classes[0]?.topic_name || "Topic will be updated soon" }}
</p>


          <!-- TIMES -->
          <div class="text-sm text-gray-700 space-y-1">
            <div *ngFor="let s of group.classes">
  â° {{ s.start_time }} â€“ {{ s.end_time }}
</div>

          </div>

          <!-- VIEW BUTTON -->
          <button
            (click)="viewStudyMaterials(group.classes[0])"
            class="w-full bg-[#8b6f63] text-white py-1.5 rounded-md text-sm"
          >
            View Study Materials
          </button>
        </div>

        <!-- STUDY MATERIAL -->
        <div
          *ngIf="openedSlotId === group.classes[0]?.slot_id"
          class="mt-4 border-t pt-3"
        >
          <div *ngIf="isMaterialLoading" class="text-sm text-gray-400">
            Loading study materials...
          </div>

          <div *ngIf="studyMedia.length; else noMedia" class="space-y-2">
            <div
              *ngFor="let m of studyMedia"
              class="flex items-center justify-between border rounded px-3 py-2 text-sm"
            >
              <div>
                <div class="font-medium">{{ m.title || m.file_name }}</div>
                <div class="text-xs text-gray-400">{{ m.mime_type }}</div>
              </div>

              <button
                (click)="openFile(m.file_path)"
                class="bg-emerald-600 text-white px-3 py-1 rounded text-xs"
              >
                View
              </button>
            </div>
          </div>

          <ng-template #noMedia>
            <div class="text-xs italic text-gray-400">
              No study materials uploaded
            </div>
          </ng-template>
        </div>

      </div>
    </div>
  </ng-container>

  <!-- NO DATA -->
  <ng-template #noData>
    <div class="text-center py-6 italic text-gray-400">
      No classes found
    </div>
  </ng-template>

</div>
